## L3AK - [100 point]


> what is what?


> Author: etern1ty

- Explanation
 <p>Diberikan sebuah file Python, dan 1 file output dari program tersebut, yang kemungkinan berisi flag</p>
 
 ### chall.py
 ```py
from Crypto.Util.number import *
with open('flag.txt') as f:
    flag = f.read().strip()

p = getPrime(512)
q = getPrime(512)
n = p * q
phi = (p - 1) * (q - 1)

e = 65537
d = inverse(e, phi)
what = d % (p - 1)

ct = pow(bytes_to_long(flag.encode()), e, n)
with open('output.txt', 'w') as f:
    f.write(f'n = {n}\n')
    f.write(f'ct = {ct}\n')
    f.write(f'what = {what}\n')
 ```

### output.txt
```
n = 132424945097525850654214822436841749617596013766516589461846053019923921509419349878188173267137393388564369574894943951802964034938666342594121858359017467945336230806773103437033058400722533249173019431218833060574032187854004778243330232248639993250668984287478087484530899867973181768171106834615858816947
ct = 8690256152525015206584791844752543379719744787620368046544606811870676380837374553817755653019413372016870108768104936568432345008226950086769230094097164464486596908050930851678115904352532562944170575365724833300330295692157262447360439786705110831106538310141401194897207768598781335529794463310318530218
what = 4701066001566933468539295457165541117336002410834834617743586840140912396231299819496271034686173752299173098904260222360140687146281504574213995930648721
```
<p> Ini merupakan RSA sederhana, bisa dilihat pada</p>
https://id.wikipedia.org/wiki/RSA

### decode.py
```py
from Crypto.Util.number import long_to_bytes, inverse
import math

n = 132424945097525850654214822436841749617596013766516589461846053019923921509419349878188173267137393388564369574894943951802964034938666342594121858359017467945336230806773103437033058400722533249173019431218833060574032187854004778243330232248639993250668984287478087484530899867973181768171106834615858816947
ct = 8690256152525015206584791844752543379719744787620368046544606811870676380837374553817755653019413372016870108768104936568432345008226950086769230094097164464486596908050930851678115904352532562944170575365724833300330295692157262447360439786705110831106538310141401194897207768598781335529794463310318530218
what = 4701066001566933468539295457165541117336002410834834617743586840140912396231299819496271034686173752299173098904260222360140687146281504574213995930648721
e = 65537


x = pow(ct, what, n)


g = math.gcd(pow(x, e, n) - ct, n)
p = g
q = n // p


phi = (p-1)*(q-1)
d = inverse(e, phi)
m = pow(ct, d, n)

print("p bitlen:", p.bit_length())
print("q bitlen:", q.bit_length())
print("flag:", long_to_bytes(m))

```

 <p></p>
 
## Flag = HCS{leak_l3ak_l34k_i_hate_leaks_65746572}



